# 索引结构面试题



## 1、MySQL有哪些索引

MySQL有 B+ 树索引、哈希索引、全文索引这三种索引。常用的是 B+ 树索引，以为它是 InnoDB 引擎默认使用的索引类型，支持排序、分组、范围查询、模糊查询等功能。

## 2、InnoDB 引擎的索引数据结构是什么

InnoDB 的索引数据结构是 B+ 树

它的特点是 B+ 树的非叶子节点，只存放数据的主键值，而不存放实际的数据。叶子节点存储索引和实际的数据。

所有叶子节点通过指针相连，形成一个双向链表，支持快速的顺序访问和范围查询

## 3、B+ 树的特性是什么

* 叶子节点存储索引和数据，非叶子节点（中间节点）只存储索引，不存储数据
* 叶子节点之间通过双向链表串联在一起
* B+ 树存储千万级别的数据，树的高度依然维持在 3~4 层左右，也就是从千万级数据中查询一条数据只需要 3~4 次磁盘IO

## 4、B+ 树和 B树有什么区别

> 从三个角度回答
>
> * 数据存储的区别
> * 范围查询的区别
> * 查询效率的区别

* B树所有的节点都会存储索引 + 数据，而B+ 树只有叶子节点才会存储数据，中间节点只存储索引，因此存储形同数据量的情况下，B+ 树比B 树更矮胖（因为非叶子节点存储的索引数量远大于 B树），查询叶子节点的磁盘 IO 次数更少。
* B+ 树叶子节点之间会通过双向指针串联在一起，构成一个双向链表，这种设计对范围查询非常有帮助。而 B树 没有将所有叶子节点用链表串联起来。只能通过遍历来完成范围查询。对比 B+ 树会涉及更多的 IO 操作，查询效率不如 B+ 树
* B树的优势是，要查询的值恰好在非叶子时，由于该节点也存储实际数据。所以比B+ 树更快。但是B+ 树的查询会更**稳定**，因为每次查询都是相同的 IO 延迟。

B+ 树比 B 树更**稳定的原因**：

* B+ 树在插入和删除操作时，通过分裂和合并节点来保持树的平衡。这些操作主要影响叶子节点，对内部节点影响较小。
* B 树在插入和删除操作时，可能需要重新平衡整个树，包括内部节点和叶子节点，这可能导致更频繁的节点分裂和合并，增加了操作的复杂性和不稳定性

## 5、MySQL为什么使用 B+ 树

* B+ 树是多叉树，而平衡二叉树、红黑树是二叉树，在同等数据量下，平衡二叉树、红黑树高度更高，查询数据的时候需要的 IO 次数会更多，性能更差，而且它们会频繁的执行再平衡过程，来保证树的平衡
* 跳表和 B+ 树相比，跳表在极端情况下会退化成链表，平衡性差，而数据库查询需要一个可预期的查询时间，并且跳表需要更多的内存
* B 树和 B+ 树相比，B树的的数据存储在所有节点中，对范围查询不友好。非叶子节点中存储了数据，导致内存中难以存放全部的非叶子节点，意味着查询非叶子节点的时候需要磁盘 IO

## 6、B+ 树的优点和缺点

* B+ 树最大的优点就是可以方便的进行范围查询
* B+ 树最大的性能问题是会产生大量的随机 IO ，例如在插入一个 key 跨度很大的数据时,由于新插入的数据在磁盘上的物理位置相隔很远，就会产生大量的随机写 IO